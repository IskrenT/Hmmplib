<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hmmplib Documentation: hmmp_algwrap.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hmmplib Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('hmmp__algwrap_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hmmp_algwrap.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Memory allocation and calls to the algorithmic implementations of HMM.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="hmmp__datatypes_8h_source.html">hmmp_datatypes.h</a>&quot;</code><br />
</div>
<p><a href="hmmp__algwrap_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a77d31cb59def46e263dbc6c1b839acfe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hmmp__algwrap_8h.html#a77d31cb59def46e263dbc6c1b839acfe">hmmp_forward</a> (<a class="el" href="hmmp__datatypes_8h.html#a1f8a4c835286779511b75539eb760d4a">hmmp_Model</a> *model, <a class="el" href="hmmp__datatypes_8h.html#a2caa44c22b290e74966712d65b434702">hmmp_Sequence</a> seq, <a class="el" href="hmmp__datatypes_8h.html#a6e8b549220463d11c749c9a2f101ceee">dbl_matrix</a> **o_addr_alfa, <a class="el" href="hmmp__datatypes_8h.html#a3f308cafd9c0390f0966aefdd86eaed5">dbl_array</a> **o_scale_arr)</td></tr>
<tr class="memdesc:a77d31cb59def46e263dbc6c1b839acfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the forward algorithm on a model and a sequence including memory allocation.  <a href="#a77d31cb59def46e263dbc6c1b839acfe">More...</a><br /></td></tr>
<tr class="separator:a77d31cb59def46e263dbc6c1b839acfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe5383fc9873ca7faee2bc4739ac8023"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hmmp__algwrap_8h.html#abe5383fc9873ca7faee2bc4739ac8023">hmmp_backward</a> (<a class="el" href="hmmp__datatypes_8h.html#a1f8a4c835286779511b75539eb760d4a">hmmp_Model</a> *model, <a class="el" href="hmmp__datatypes_8h.html#a2caa44c22b290e74966712d65b434702">hmmp_Sequence</a> seq, <a class="el" href="hmmp__datatypes_8h.html#a6e8b549220463d11c749c9a2f101ceee">dbl_matrix</a> **o_addr_beta, <a class="el" href="hmmp__datatypes_8h.html#a3f308cafd9c0390f0966aefdd86eaed5">dbl_array</a> **o_scale_arr)</td></tr>
<tr class="memdesc:abe5383fc9873ca7faee2bc4739ac8023"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the backward algorithm on a model and a sequence including memory allocation.  <a href="#abe5383fc9873ca7faee2bc4739ac8023">More...</a><br /></td></tr>
<tr class="separator:abe5383fc9873ca7faee2bc4739ac8023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e827aeb6d2e26234c22bf60065bcca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hmmp__algwrap_8h.html#a93e827aeb6d2e26234c22bf60065bcca">hmmp_viterbi</a> (<a class="el" href="hmmp__datatypes_8h.html#a1f8a4c835286779511b75539eb760d4a">hmmp_Model</a> log_model, <a class="el" href="hmmp__datatypes_8h.html#a2caa44c22b290e74966712d65b434702">hmmp_Sequence</a> obs_seq, <a class="el" href="hmmp__datatypes_8h.html#a2caa44c22b290e74966712d65b434702">hmmp_Sequence</a> *o_state_seq, double *o_logP)</td></tr>
<tr class="memdesc:a93e827aeb6d2e26234c22bf60065bcca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the Viterbi algorithm on a model and a sequence including memory allocation.  <a href="#a93e827aeb6d2e26234c22bf60065bcca">More...</a><br /></td></tr>
<tr class="separator:a93e827aeb6d2e26234c22bf60065bcca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Memory allocation and calls to the algorithmic implementations of HMM. </p>
<p>This file contains "wrappers" to the algorithmic solutions. These wrappers allocate memory for the necessery internal variables for the algorithms. Only use the plain algorithmic solutions if reusing the memory containers for different steps is necessery. For the plain algorithmic solutions check: <a class="el" href="hmmp__alg_8h.html" title="Contains the algorithmic implementations of HMM. ">hmmp_alg.h</a> . For the more general abstract parralel solutions to HMM check: <a class="el" href="hmmp__general_8h.html" title="Contains all the library high-level entry points. ">hmmp_general.h</a></p>
<p>The functions in this files are suitable for executing any of the algorithms once. If multiple executions are needed consider using the solutions in <a class="el" href="hmmp__general_8h.html" title="Contains all the library high-level entry points. ">hmmp_general.h</a></p>
<p><b>Some of the algorithms needs pre-allocated containers for their output data, please read the function and parameter descriptions carefully!</b></p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abe5383fc9873ca7faee2bc4739ac8023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe5383fc9873ca7faee2bc4739ac8023">&#9670;&nbsp;</a></span>hmmp_backward()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hmmp_backward </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a1f8a4c835286779511b75539eb760d4a">hmmp_Model</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a2caa44c22b290e74966712d65b434702">hmmp_Sequence</a>&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a6e8b549220463d11c749c9a2f101ceee">dbl_matrix</a> **&#160;</td>
          <td class="paramname"><em>o_addr_beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a3f308cafd9c0390f0966aefdd86eaed5">dbl_array</a> **&#160;</td>
          <td class="paramname"><em>o_scale_arr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the backward algorithm on a model and a sequence including memory allocation. </p>
<p>The backward algorithm is used to obtain the backward variables. It is mostly used in the forward-backward algorithm and the Baum-Welch algorithm. It's result can also be used to obtain the probability of the model to have produced the sequence. For more information check <a class="el" href="general.html">General Usage</a> .</p>
<p>To use this function pointers to a matrix and an array must be declared. At the function call provide the addresses of these pointers. After a return of the function these pointers will contain the addresses to the resuting data structures. If the function failed to allocate memory for these data structures, the values of the pointers will be 0 ( NULL ) and the return value of the function will be an error code.</p>
<p>After using this function the user is responsible to destroy and free the memory allocated to the resulting data structures. This can be done using the appropriate functions declared in <a class="el" href="hmmp__memop_8h.html" title="Contains memory allocation and deallocation functions for models and sequences. ">hmmp_memop.h</a> .</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>The model to execute algorithm on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seq</td><td>The sequence to execute algorithm on </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">o_addr_beta</td><td>Address of a pointer that would receive the address of the resulting matrix of backward variables. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">o_scale_arr</td><td>Address of a pointer that would receive the address of the resulting array containing the scaling factors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="hmmp__datatypes_8h.html#aa7b1038d15d686f2756ee4d2ebc67197">hmmp_Error</a> type </dd></dl>
<dl class="section see"><dt>See also</dt><dd>Use <a class="el" href="hmmp__alg_8h.html#a7758852926a707bfaba2df924d33ec0c" title="Execute the backward algorithm on a model and a sequence. ">hmmp_backward_alg()</a> instead if want to allocate the memory yourself. Use <a class="el" href="hmmp__general_8h.html#a365bbe8ca0c04cb1712a738f7acc820e" title="Use Hmmplib for learning with a single model and multiple sequences. ">hmmp_baum_welch()</a> if you wan't to use the backward algorithm for learining in the Baum-Welch algorithm. For evaluation use <a class="el" href="hmmp__general_8h.html#ae8b19e14e2a9ee4043c1ee62e943d4f1" title="Use Hmmplib for evaluation with a single models and multiple sequence. ">hmmp_evaluate_sequences()</a> that utilizes the forward algorithm. </dd></dl>

</div>
</div>
<a id="a77d31cb59def46e263dbc6c1b839acfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77d31cb59def46e263dbc6c1b839acfe">&#9670;&nbsp;</a></span>hmmp_forward()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hmmp_forward </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a1f8a4c835286779511b75539eb760d4a">hmmp_Model</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a2caa44c22b290e74966712d65b434702">hmmp_Sequence</a>&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a6e8b549220463d11c749c9a2f101ceee">dbl_matrix</a> **&#160;</td>
          <td class="paramname"><em>o_addr_alfa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a3f308cafd9c0390f0966aefdd86eaed5">dbl_array</a> **&#160;</td>
          <td class="paramname"><em>o_scale_arr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the forward algorithm on a model and a sequence including memory allocation. </p>
<p>The forward algorithm is used to obtain the forward variables. From the forward variables the probability of the model to have produced the sequence can be obtained. For more information check <a class="el" href="general.html">General Usage</a> .</p>
<p>To use this function pointers to a matrix and an array must be declared. At the function call provide the addresses of these pointers. After a return of the function these pointers will contain the addresses to the resuting data structures. If the function failed to allocate memory for these data structures, the values of the pointers will be 0 ( NULL ) and the return value of the function will be an hmmp_Error code.</p>
<p>After using this function the user is responsible to destroy and free the memory allocated to the resulting data structures. This can be done using the appropriate functions declared in <a class="el" href="hmmp__memop_8h.html" title="Contains memory allocation and deallocation functions for models and sequences. ">hmmp_memop.h</a> .</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>The model to execute algorithm on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seq</td><td>The sequence to execute algorithm on </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">o_addr_alfa</td><td>Address of a pointer that would receive the address of the resulting matrix of forward variables. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">o_scale_arr</td><td>Address of a pointer that would receive the address of the resulting array containing the scaling factors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="hmmp__datatypes_8h.html#aa7b1038d15d686f2756ee4d2ebc67197">hmmp_Error</a> type </dd></dl>
<dl class="section see"><dt>See also</dt><dd>Use <a class="el" href="hmmp__alg_8h.html#a14f81c6b42c91d42083c253880a9b03f" title="Execute the forward algorithm on a model and a sequence. ">hmmp_forward_alg()</a> instead if want to allocate the memory yourself. Use <a class="el" href="hmmp__general_8h.html#ae8b19e14e2a9ee4043c1ee62e943d4f1" title="Use Hmmplib for evaluation with a single models and multiple sequence. ">hmmp_evaluate_sequences()</a> if you wan't to use the forward algorithm for evaluation. </dd></dl>

</div>
</div>
<a id="a93e827aeb6d2e26234c22bf60065bcca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93e827aeb6d2e26234c22bf60065bcca">&#9670;&nbsp;</a></span>hmmp_viterbi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hmmp_viterbi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a1f8a4c835286779511b75539eb760d4a">hmmp_Model</a>&#160;</td>
          <td class="paramname"><em>log_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a2caa44c22b290e74966712d65b434702">hmmp_Sequence</a>&#160;</td>
          <td class="paramname"><em>obs_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hmmp__datatypes_8h.html#a2caa44c22b290e74966712d65b434702">hmmp_Sequence</a> *&#160;</td>
          <td class="paramname"><em>o_state_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>o_logP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the Viterbi algorithm on a model and a sequence including memory allocation. </p>
<p>Viterbi's algorithm is used for decoding, or finding the best matching state sequence to a sequence of observable symbols. For a configuration of a single model and multiple sequence use <a class="el" href="hmmp__general_8h.html#abe53b2661540297d5bc74e1919c9000a" title="Use Hmmplib for decoding with a single model and multiple sequences. ">hmmp_decode()</a> instead.</p>
<p>To use this function the input model should have logarithmic probabilities in the parameters. Use <a class="el" href="hmmp__dataproc_8h.html#a48800faa3cbdc926119a18dad7687688" title="Change the model parameters to logarithmic scale. ">hmmp_model_log_param()</a> to logarithmize the model parameters. Use a copy of the model if you don't want to manipulate the original model. To create a copy <a class="el" href="hmmp__memop_8h.html#a425e1616a6e0b60dbc773a7aabe35977" title="Create an copy of an existing model. ">hmmp_create_model_copy()</a> can be used.</p>
<p><b>Note: This function does not requre allocation of the internal data structures used By the Viterbi algorithm, BUT it DOES REQUIRE allocation of the containers that will hold the results.</b></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">log_model</td><td>The model with logarithmized parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obs_seq</td><td>The sequence to execute algorithm on </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">o_state_seq</td><td>Address of pre-allocated uninitialized sequence to hold result </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">o_logP</td><td>Address of a double variable to hold the resulting probability </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="hmmp__datatypes_8h.html#aa7b1038d15d686f2756ee4d2ebc67197">hmmp_Error</a> type </dd></dl>
<dl class="section see"><dt>See also</dt><dd>Use <a class="el" href="hmmp__alg_8h.html#a3478a87b6ee3e04b5586ddc065c4cf7c" title="Vitebri&#39;s algorithm for finding the best matching state sequence to a sequence of symbols...">hmmp_viterbi_alg()</a> if you want to allocate internal variables yourself. Use <a class="el" href="hmmp__general_8h.html#abe53b2661540297d5bc74e1919c9000a" title="Use Hmmplib for decoding with a single model and multiple sequences. ">hmmp_decode()</a> if you want to use viterbi algorithm for decoding with configuration of multiple-sequences ( or one ) and one model. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_885cc87fac2d91e269af0a5a959fa5f6.html">E:</a></li><li class="navelem"><a class="el" href="dir_4bc400ee5a2209a8c93f055d0c1bc7a9.html">github_projects</a></li><li class="navelem"><a class="el" href="dir_327d278e1e10d50b9a9db13342b145a7.html">Hmmplib</a></li><li class="navelem"><a class="el" href="dir_b53decae00779817c1411cbf5034b172.html">Hmmplib</a></li><li class="navelem"><a class="el" href="hmmp__algwrap_8h.html">hmmp_algwrap.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
